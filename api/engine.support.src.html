
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8">
   <title>engine.support.js</title>
   <link rel=stylesheet href="default.css" type="text/css" media=screen>
   <meta name="generator" content="JsDoc Toolkit 1.0">
   <style>
      body {
         font-size: 10pt;
         font-family: Helvetica, Arial, san-serif;
      }

      .TableHeadingColor { font-size: 18pt; font-weight: bold; background: #CCCCFF; }
      .TableRowColor { background: #FFFFFF; }
      
      .jsdoc_ctime
      {
         font-family: Arial, Helvetica, sans-serif;
         font-size: 9pt;
         text-align: right;
      }
      .jsdoc_copy
      {
         font-family: Arial, Helvetica, sans-serif;
         font-size: 9pt;
         text-align: left;
         font-style: italic;
      }
   </style>
</head>
<body>
<div style="text-align: center;">
   <h1>engine.support.js</h1>
</div>
<br/>
<h4>Summary</h4>
A support class for the engine with useful methods              to manipulate arrays, parse JSON, and handle query parameters.

<br/>
<hr>
<table border="1" width="100%" cellpadding="2">
   <tr>
      <td colspan="2" class="TableHeadingColor">Class Summary</td>
   </tr>
   
      <tr class="TableRowColor">
         <td>
            <a href="EngineSupport.html" target="main">EngineSupport</a>
         </td>
         <td>
            
A static class with support methods the engine or games can use.
         </td>
      </tr>
   
</table>
<br/>
<hr>
<style>
         .KEYW {color: #933;}
         .COMM {color: #bbb; font-style: italic;}
         .NUMB {color: #393;}
         .STRN {color: #393;}
         .REGX {color: #339;}
         .linenumber {border-right: 1px dotted #666; color: #666; font-style: normal;}
         </style><pre><span class='linenumber'>  1</span> <span class="WHIT">
<span class='linenumber'>  2</span> </span><span class="COMM">/**
<span class='linenumber'>  3</span>  * The Render Engine
<span class='linenumber'>  4</span>  * Engine Support Class
<span class='linenumber'>  5</span>  *
<span class='linenumber'>  6</span>  * @fileoverview A support class for the engine with useful methods
<span class='linenumber'>  7</span>  *               to manipulate arrays, parse JSON, and handle query parameters.
<span class='linenumber'>  8</span>  *
<span class='linenumber'>  9</span>  * @author: Brett Fattori (brettf@renderengine.com)
<span class='linenumber'> 10</span>  * @author: $Author: bfattori $
<span class='linenumber'> 11</span>  * @version: $Revision: 1408 $
<span class='linenumber'> 12</span>  *
<span class='linenumber'> 13</span>  * Copyright (c) 2010 Brett Fattori (brettf@renderengine.com)
<span class='linenumber'> 14</span>  *
<span class='linenumber'> 15</span>  * Permission is hereby granted, free of charge, to any person obtaining a copy
<span class='linenumber'> 16</span>  * of this software and associated documentation files (the "Software"), to deal
<span class='linenumber'> 17</span>  * in the Software without restriction, including without limitation the rights
<span class='linenumber'> 18</span>  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
<span class='linenumber'> 19</span>  * copies of the Software, and to permit persons to whom the Software is
<span class='linenumber'> 20</span>  * furnished to do so, subject to the following conditions:
<span class='linenumber'> 21</span>  *
<span class='linenumber'> 22</span>  * The above copyright notice and this permission notice shall be included in
<span class='linenumber'> 23</span>  * all copies or substantial portions of the Software.
<span class='linenumber'> 24</span>  *
<span class='linenumber'> 25</span>  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
<span class='linenumber'> 26</span>  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
<span class='linenumber'> 27</span>  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
<span class='linenumber'> 28</span>  * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
<span class='linenumber'> 29</span>  * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
<span class='linenumber'> 30</span>  * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
<span class='linenumber'> 31</span>  * THE SOFTWARE.
<span class='linenumber'> 32</span>  *
<span class='linenumber'> 33</span>  */</span><span class="WHIT">
<span class='linenumber'> 34</span> 
<span class='linenumber'> 35</span> </span><span class="COMM">/**
<span class='linenumber'> 36</span>  * @class A static class with support methods the engine or games can use.  
<span class='linenumber'> 37</span>  *        Many of the methods can be used to manipulate arrays.  Additional
<span class='linenumber'> 38</span>  *        methods are provided to access query parameters, and generate and/or 
<span class='linenumber'> 39</span>  *        read JSON.
<span class='linenumber'> 40</span>  * @static
<span class='linenumber'> 41</span>  */</span><span class="WHIT">
<span class='linenumber'> 42</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">EngineSupport</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Base.extend</span><span class="PUNC">(</span><span class="COMM">/** @scope EngineSupport.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 43</span> </span><span class="WHIT">   </span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 44</span> 
<span class='linenumber'> 45</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'> 46</span>     * Get the index of an element in the specified array.
<span class='linenumber'> 47</span>     *
<span class='linenumber'> 48</span>     * @param array {Array} The array to scan
<span class='linenumber'> 49</span>     * @param obj {Object} The object to find
<span class='linenumber'> 50</span>     * @param [from=0] {Number} The index to start at, defaults to zero.
<span class='linenumber'> 51</span>     * @memberOf EngineSupport
<span class='linenumber'> 52</span>     */</span><span class="WHIT">
<span class='linenumber'> 53</span> </span><span class="WHIT">   </span><span class="NAME">indexOf</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">array</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">from</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 54</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">array</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 55</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 56</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 57</span> 
<span class='linenumber'> 58</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Array.prototype.indexOf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 59</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">array.indexOf</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">from</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 60</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 61</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT">
<span class='linenumber'> 62</span> </span><span class="WHIT">      </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 63</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 64</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">from</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">from</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 65</span> </span><span class="WHIT">         </span><span class="NAME">from</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">from</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 66</span> </span><span class="WHIT">            </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">from</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 67</span> </span><span class="WHIT">            </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">from</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 68</span> </span><span class="WHIT">         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">from</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 69</span> </span><span class="WHIT">            </span><span class="NAME">from</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 70</span> 
<span class='linenumber'> 71</span> </span><span class="WHIT">         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">from</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">from</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 72</span> </span><span class="WHIT">         </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 73</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">from</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">[</span><span class="NAME">from</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 74</span> </span><span class="WHIT">               </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">from</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 75</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 76</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 77</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 78</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 79</span> 
<span class='linenumber'> 80</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'> 81</span>     * Remove an element from an array.  This method modifies the array
<span class='linenumber'> 82</span>     * directly.
<span class='linenumber'> 83</span>     *
<span class='linenumber'> 84</span>     * @param array {Array} The array to modify
<span class='linenumber'> 85</span>     * @param obj {Object} The object to remove
<span class='linenumber'> 86</span>     * @memberOf EngineSupport
<span class='linenumber'> 87</span>     */</span><span class="WHIT">
<span class='linenumber'> 88</span> </span><span class="WHIT">   </span><span class="NAME">arrayRemove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">array</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 89</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">array</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 90</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 91</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 92</span> 
<span class='linenumber'> 93</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">EngineSupport.indexOf</span><span class="PUNC">(</span><span class="NAME">array</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 94</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 95</span> </span><span class="WHIT">      </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 96</span> </span><span class="WHIT">         </span><span class="NAME">array.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 97</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 98</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 99</span> </span><span class="WHIT">   </span><span class="WHIT">
<span class='linenumber'>100</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>101</span>     * Returns &lt;tt>true&lt;/tt> if the string, after trimming, is either
<span class='linenumber'>102</span>     * empty or is null.
<span class='linenumber'>103</span>     * 
<span class='linenumber'>104</span>     * @param str {String} The string to test
<span class='linenumber'>105</span>     * @return {Boolean} &lt;tt>true&lt;/tt> if the string is empty or &lt;tt>null&lt;/tt>
<span class='linenumber'>106</span>     */</span><span class="WHIT">
<span class='linenumber'>107</span> </span><span class="WHIT">   </span><span class="NAME">isEmpty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>108</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">$.trim</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">     </span><span class="WHIT">
<span class='linenumber'>109</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>110</span> 
<span class='linenumber'>111</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>112</span>     * Calls a provided callback function once for each element in
<span class='linenumber'>113</span>     * an array, and constructs a new array of all the values for which
<span class='linenumber'>114</span>     * callback returns a &lt;tt>true&lt;/tt> value. callback is invoked only
<span class='linenumber'>115</span>     * for indexes of the array which have assigned values; it is not invoked
<span class='linenumber'>116</span>     * for indexes which have been deleted or which have never been assigned
<span class='linenumber'>117</span>     * values. Array elements which do not pass the callback test are simply
<span class='linenumber'>118</span>     * skipped, and are not included in the new array.
<span class='linenumber'>119</span>     *
<span class='linenumber'>120</span>     * @param array {Array} The array to filter.
<span class='linenumber'>121</span>     * @param fn {Function} The callback to invoke.  It will be passed three
<span class='linenumber'>122</span>     *                      arguments: The element value, the index of the element,
<span class='linenumber'>123</span>     *                      and the array being traversed.
<span class='linenumber'>124</span>     * @param [thisp=null] {Object} Used as &lt;tt>this&lt;/tt> for each invocation of the
<span class='linenumber'>125</span>     *                       callback.
<span class='linenumber'>126</span>     * @memberOf EngineSupport
<span class='linenumber'>127</span>     */</span><span class="WHIT">
<span class='linenumber'>128</span> </span><span class="WHIT">   </span><span class="NAME">filter</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">array</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">thisp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>129</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">array</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>130</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>131</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>132</span> 
<span class='linenumber'>133</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Array.prototype.filter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>134</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">array.filter</span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">thisp</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>135</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>136</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT">
<span class='linenumber'>137</span> </span><span class="WHIT">      </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>138</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>139</span> </span><span class="WHIT">         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>140</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>141</span> 
<span class='linenumber'>142</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>143</span> </span><span class="WHIT">         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>144</span> </span><span class="WHIT">         </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>145</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>146</span> </span><span class="WHIT">            </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>147</span> </span><span class="WHIT">               </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// in case fn mutates this</span><span class="WHIT">
<span class='linenumber'>148</span> </span><span class="WHIT">               </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn.call</span><span class="PUNC">(</span><span class="NAME">thisp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>149</span> </span><span class="WHIT">                  </span><span class="NAME">res.push</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>150</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>151</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>152</span> 
<span class='linenumber'>153</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>154</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>155</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>156</span> 
<span class='linenumber'>157</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>158</span>     * Executes a callback for each element within an array.
<span class='linenumber'>159</span>     *
<span class='linenumber'>160</span>     * @param array {Array} The array to operate on
<span class='linenumber'>161</span>     * @param fn {Function} The function to apply to each element.  It will be passed three
<span class='linenumber'>162</span>     *                      arguments: The element value, the index of the element,
<span class='linenumber'>163</span>     *                      and the array being traversed.
<span class='linenumber'>164</span>     * @param [thisp=null] {Object} An optional "this" pointer to use in the callback
<span class='linenumber'>165</span>     * @memberOf EngineSupport
<span class='linenumber'>166</span>     */</span><span class="WHIT">
<span class='linenumber'>167</span> </span><span class="WHIT">   </span><span class="NAME">forEach</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">array</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">thisp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>168</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">array</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>169</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>170</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>171</span> 
<span class='linenumber'>172</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Array.prototype.forEach</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>173</span> </span><span class="WHIT">         </span><span class="NAME">array.forEach</span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">thisp</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>174</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>175</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT">
<span class='linenumber'>176</span> </span><span class="WHIT">      </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>177</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>178</span> </span><span class="WHIT">         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>179</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>180</span> 
<span class='linenumber'>181</span> </span><span class="WHIT">         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>182</span> </span><span class="WHIT">         </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>183</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>184</span> </span><span class="WHIT">               </span><span class="NAME">fn.call</span><span class="PUNC">(</span><span class="NAME">thisp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>185</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>186</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>187</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>188</span> 
<span class='linenumber'>189</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>190</span>     * Fill the specified array with &lt;tt>size&lt;/tt> elements
<span class='linenumber'>191</span>     * each with the value "&lt;tt>value&lt;/tt>".  Modifies the provided
<span class='linenumber'>192</span>     * array directly.
<span class='linenumber'>193</span>     *
<span class='linenumber'>194</span>     * @param {Array} arr The array to fill
<span class='linenumber'>195</span>     * @param {Number} size The size of the array to fill
<span class='linenumber'>196</span>     * @param {Object} value The value to put at each index
<span class='linenumber'>197</span>     * @memberOf EngineSupport
<span class='linenumber'>198</span>     */</span><span class="WHIT">
<span class='linenumber'>199</span> </span><span class="WHIT">   </span><span class="NAME">fillArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">size</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>200</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">size</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>201</span> </span><span class="WHIT">         </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>202</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>203</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>204</span> 
<span class='linenumber'>205</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>206</span>     * Get the path from a fully qualified URL, not including the trailing
<span class='linenumber'>207</span>     * slash character.
<span class='linenumber'>208</span>     *
<span class='linenumber'>209</span>     * @param url {String} The URL
<span class='linenumber'>210</span>     * @return {String} The path
<span class='linenumber'>211</span>     * @memberOf EngineSupport
<span class='linenumber'>212</span>     */</span><span class="WHIT">
<span class='linenumber'>213</span> </span><span class="WHIT">   </span><span class="NAME">getPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>214</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">"/"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>215</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">url.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>216</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>217</span> 
<span class='linenumber'>218</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>219</span>     * Get the query parameters from the window location object.  The
<span class='linenumber'>220</span>     * object returned will contain a key/value pair for each argument
<span class='linenumber'>221</span>     * found.
<span class='linenumber'>222</span>     *
<span class='linenumber'>223</span>     * @return {Object} A generic &lt;tt>Object&lt;/tt> with a key and value for each query argument.
<span class='linenumber'>224</span>     * @memberOf EngineSupport
<span class='linenumber'>225</span>     */</span><span class="WHIT">
<span class='linenumber'>226</span> </span><span class="WHIT">   </span><span class="NAME">getQueryParams</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>227</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">EngineSupport.parms</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>228</span> </span><span class="WHIT">         </span><span class="NAME">EngineSupport.parms</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>229</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.location.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>230</span> </span><span class="WHIT">         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>231</span> </span><span class="WHIT">         </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>232</span> </span><span class="WHIT">            </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p.split</span><span class="PUNC">(</span><span class="STRN">"&"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>233</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">p.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>234</span> </span><span class="WHIT">            </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>235</span> </span><span class="WHIT">               </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">"="</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>236</span> </span><span class="WHIT">               </span><span class="NAME">EngineSupport.parms</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>237</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>238</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>239</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>240</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">EngineSupport.parms</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>241</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>242</span> 
<span class='linenumber'>243</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>244</span>     * Check for a query parameter and to see if it evaluates to one of the following:
<span class='linenumber'>245</span>     * &lt;tt>true&lt;/tt>, &lt;tt>1&lt;/tt>, &lt;tt>yes&lt;/tt>, or &lt;tt>y&lt;/tt>.  If so, returns &lt;tt>true&lt;/tt>.
<span class='linenumber'>246</span>     *
<span class='linenumber'>247</span>     * @param paramName {String} The query parameter name
<span class='linenumber'>248</span>     * @return {Boolean} &lt;tt>true&lt;/tt> if the query parameter exists and is one of the specified values.
<span class='linenumber'>249</span>     * @memberOf EngineSupport
<span class='linenumber'>250</span>     */</span><span class="WHIT">
<span class='linenumber'>251</span> </span><span class="WHIT">   </span><span class="NAME">checkBooleanParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>252</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">EngineSupport.getQueryParams</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">paramName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT">
<span class='linenumber'>253</span> </span><span class="WHIT">              </span><span class="PUNC">(</span><span class="NAME">EngineSupport.getQueryParams</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">paramName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"true"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class='linenumber'>254</span> </span><span class="WHIT">               </span><span class="NAME">EngineSupport.getQueryParams</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">paramName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"1"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class='linenumber'>255</span> </span><span class="WHIT">               </span><span class="NAME">EngineSupport.getQueryParams</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">paramName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"yes"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class='linenumber'>256</span> </span><span class="WHIT">               </span><span class="NAME">EngineSupport.getQueryParams</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">paramName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"y"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>257</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>258</span> 
<span class='linenumber'>259</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>260</span>     * Check for a query parameter and to see if it evaluates to the specified value.
<span class='linenumber'>261</span>     * If so, returns &lt;tt>true&lt;/tt>.
<span class='linenumber'>262</span>     *
<span class='linenumber'>263</span>     * @param paramName {String} The query parameter name
<span class='linenumber'>264</span>     * @param val {String} The value to check for
<span class='linenumber'>265</span>     * @return {Boolean} &lt;tt>true&lt;/tt> if the query parameter exists and is the value specified
<span class='linenumber'>266</span>     * @memberOf EngineSupport
<span class='linenumber'>267</span>     */</span><span class="WHIT">
<span class='linenumber'>268</span> </span><span class="WHIT">   </span><span class="NAME">checkStringParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>269</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">EngineSupport.getStringParam</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>270</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>271</span> 
<span class='linenumber'>272</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>273</span>     * Check for a query parameter and to see if it evaluates to the specified number.
<span class='linenumber'>274</span>     * If so, returns &lt;tt>true&lt;/tt>.
<span class='linenumber'>275</span>     *
<span class='linenumber'>276</span>     * @param paramName {String} The query parameter name
<span class='linenumber'>277</span>     * @param val {Number} The number to check for
<span class='linenumber'>278</span>     * @return {Boolean} &lt;tt>true&lt;/tt> if the query parameter exists and is the value specified
<span class='linenumber'>279</span>     * @memberOf EngineSupport
<span class='linenumber'>280</span>     */</span><span class="WHIT">
<span class='linenumber'>281</span> </span><span class="WHIT">   </span><span class="NAME">checkNumericParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>282</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">EngineSupport.getStringParam</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>283</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>284</span> 
<span class='linenumber'>285</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>286</span>     * Get a numeric query parameter, or the default specified if the parameter
<span class='linenumber'>287</span>     * doesn't exist.
<span class='linenumber'>288</span>     *
<span class='linenumber'>289</span>     * @param paramName {String} The name of the parameter
<span class='linenumber'>290</span>     * @param defaultVal {Number} The number to return if the parameter doesn't exist
<span class='linenumber'>291</span>     * @return {Number} The value
<span class='linenumber'>292</span>     * @memberOf EngineSupport
<span class='linenumber'>293</span>     */</span><span class="WHIT">
<span class='linenumber'>294</span> </span><span class="WHIT">   </span><span class="NAME">getNumericParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">defaultVal</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>295</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">EngineSupport.getStringParam</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">defaultVal</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>296</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>297</span> 
<span class='linenumber'>298</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>299</span>     * Get a string query parameter, or the default specified if the parameter
<span class='linenumber'>300</span>     * doesn't exist.
<span class='linenumber'>301</span>     *
<span class='linenumber'>302</span>     * @param paramName {String} The name of the parameter
<span class='linenumber'>303</span>     * @param defaultVal {String} The string to return if the parameter doesn't exist
<span class='linenumber'>304</span>     * @return {String} The value
<span class='linenumber'>305</span>     * @memberOf EngineSupport
<span class='linenumber'>306</span>     */</span><span class="WHIT">
<span class='linenumber'>307</span> </span><span class="WHIT">   </span><span class="NAME">getStringParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">paramName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">defaultVal</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>308</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">EngineSupport.getQueryParams</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">paramName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">defaultVal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>309</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>310</span> 
<span class='linenumber'>311</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>312</span>     * Returns specified object as a JavaScript Object Notation (JSON) string.
<span class='linenumber'>313</span>     *
<span class='linenumber'>314</span>     * Code to handle "undefined" type was delibrately not implemented, being that it is not part of JSON.
<span class='linenumber'>315</span>     * "undefined" type is casted to "null".
<span class='linenumber'>316</span>     *
<span class='linenumber'>317</span>     * @param object {Object} Must not be undefined or contain undefined types and variables.
<span class='linenumber'>318</span>     * @return String
<span class='linenumber'>319</span>     * @memberOf EngineSupport
<span class='linenumber'>320</span>     */</span><span class="WHIT">
<span class='linenumber'>321</span> </span><span class="WHIT">   </span><span class="NAME">toJSON</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>322</span> </span><span class="WHIT">   </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>323</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">JSON</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>324</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>325</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>326</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>327</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>328</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>329</span> 
<span class='linenumber'>330</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>331</span>     * Cleans up incoming source by stripping single-line comments,
<span class='linenumber'>332</span>     * multi-line comments, blank lines, new lines, and trims lines.
<span class='linenumber'>333</span>     * In other words, this is a simplification of minification.
<span class='linenumber'>334</span>     * 
<span class='linenumber'>335</span>     * /(([\"'])(\\\2|.*:\/\/|[^\/\n\r])*\2)|(//.*$)/gm
<span class='linenumber'>336</span>     * @param inString {String} The source to clean
<span class='linenumber'>337</span>     */</span><span class="WHIT">
<span class='linenumber'>338</span> </span><span class="WHIT">   </span><span class="NAME">cleanSource</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">inString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">keepNewLines</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>339</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">inString.replace</span><span class="PUNC">(</span><span class="REGX">/((["'])[^;\n\r]*\2)|(\/\/.*$)/gm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"$1"</span><span class="PUNC">)</span><span class="WHIT">  </span><span class="COMM">// Remove single line comments</span><span class="WHIT">
<span class='linenumber'>340</span> </span><span class="WHIT">                     </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\/\*(\n|.)*?\*\//gm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT">           </span><span class="COMM">// Remove multi line comments</span><span class="WHIT">
<span class='linenumber'>341</span> </span><span class="WHIT">                     </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/^[ \t]*(.*?)[ \t]*$/gm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"$1"</span><span class="PUNC">)</span><span class="WHIT">      </span><span class="COMM">// Trim lines</span><span class="WHIT">
<span class='linenumber'>342</span> </span><span class="WHIT">                     </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\s*\n$/gm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">                    </span><span class="COMM">// Remove blank lines</span><span class="WHIT">
<span class='linenumber'>343</span> </span><span class="WHIT">     </span><span class="WHIT">
<span class='linenumber'>344</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">keepNewLines</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>345</span> </span><span class="WHIT">         </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">s.replace</span><span class="PUNC">(</span><span class="REGX">/(\n|\r)/gm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">                   </span><span class="COMM">// Remove new lines</span><span class="WHIT">
<span class='linenumber'>346</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>347</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>348</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>349</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>350</span> 
<span class='linenumber'>351</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>352</span>     * Parses specified JavaScript Object Notation (JSON) string back into its corresponding object.
<span class='linenumber'>353</span>     *
<span class='linenumber'>354</span>     * @param jsonString
<span class='linenumber'>355</span>     * @return Object
<span class='linenumber'>356</span>     * @see http://www.json.org
<span class='linenumber'>357</span>     * @memberOf EngineSupport
<span class='linenumber'>358</span>     */</span><span class="WHIT">
<span class='linenumber'>359</span> </span><span class="WHIT">   </span><span class="NAME">parseJSON</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jsonString</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>360</span> </span><span class="WHIT">   </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>361</span> </span><span class="WHIT">      </span><span class="NAME">jsonString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">EngineSupport.cleanSource</span><span class="PUNC">(</span><span class="NAME">jsonString</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>362</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">JSON</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>363</span> </span><span class="WHIT">         </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>364</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">jsonString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>365</span> </span><span class="WHIT">                      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>366</span> </span><span class="WHIT">                      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>367</span> </span><span class="WHIT">                          </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>368</span> </span><span class="WHIT">                          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>369</span> </span><span class="WHIT">                              </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">Date.UTC</span><span class="PUNC">(</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>370</span> </span><span class="WHIT">                          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>371</span> </span><span class="WHIT">                      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>372</span> </span><span class="WHIT">                      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>373</span> </span><span class="WHIT">                  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>374</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>375</span> </span><span class="WHIT">            </span><span class="NAME">Console.warn</span><span class="PUNC">(</span><span class="STRN">"Cannot parse JSON: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ex.message</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>376</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>377</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>378</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>379</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">EngineSupport.evalJSON</span><span class="PUNC">(</span><span class="NAME">jsonString</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>380</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>381</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>382</span> </span><span class="WHIT">   </span><span class="WHIT">
<span class='linenumber'>383</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>384</span>     * This method does a direct &lt;tt>eval()&lt;/tt> on the JSON object and
<span class='linenumber'>385</span>     * should be avoided since it allows for XSS and other security issues.
<span class='linenumber'>386</span>     * @deprecated
<span class='linenumber'>387</span>     * @see #parseJSON
<span class='linenumber'>388</span>     */</span><span class="WHIT">
<span class='linenumber'>389</span> </span><span class="WHIT">   </span><span class="NAME">evalJSON</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jsonString</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>390</span> </span><span class="WHIT">   </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>391</span> </span><span class="WHIT">      </span><span class="NAME">jsonString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">EngineSupport.cleanSource</span><span class="PUNC">(</span><span class="NAME">jsonString</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>392</span> </span><span class="WHIT">      </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>393</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">"("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">jsonString</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="WHIT">
<span class='linenumber'>394</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>395</span> </span><span class="WHIT">         </span><span class="NAME">Console.warn</span><span class="PUNC">(</span><span class="STRN">"Cannot eval JSON: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ex.message</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>396</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>397</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>398</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>399</span> 
<span class='linenumber'>400</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>401</span>     * Return a string, enclosed in quotes.
<span class='linenumber'>402</span>     *
<span class='linenumber'>403</span>     * @param text {String} The string to quote
<span class='linenumber'>404</span>     * @return {String} The string in quotes
<span class='linenumber'>405</span>     * @memberOf EngineSupport
<span class='linenumber'>406</span>     */</span><span class="WHIT">
<span class='linenumber'>407</span> </span><span class="WHIT">   </span><span class="NAME">quoteString</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>408</span> </span><span class="WHIT">   </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>409</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">JSON</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>410</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">JSON.quote</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>411</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>412</span> </span><span class="WHIT">         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>413</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>414</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>415</span> 
<span class='linenumber'>416</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='linenumber'>417</span> 	 * Determine the OS platform from the user agent string, if possible
<span class='linenumber'>418</span> 	 * @private
<span class='linenumber'>419</span>     * @memberOf EngineSupport
<span class='linenumber'>420</span> 	 */</span><span class="WHIT">
<span class='linenumber'>421</span> </span><span class="WHIT">	</span><span class="NAME">checkOS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>422</span> </span><span class="WHIT">		</span><span class="COMM">// Scrape the userAgent to get the OS</span><span class="WHIT">
<span class='linenumber'>423</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">uA</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>424</span> </span><span class="WHIT">		</span><span class="NAME">OS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/windows nt 6\.0/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Windows Vista"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>425</span> </span><span class="WHIT">				</span><span class="REGX">/windows nt 6\.1/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Windows 7"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>426</span> </span><span class="WHIT">				</span><span class="REGX">/windows nt 5\.1/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Windows XP"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>427</span> </span><span class="WHIT">				</span><span class="REGX">/windows/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Windows"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>428</span> </span><span class="WHIT">				</span><span class="REGX">/android 1\./</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Android 1.x"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>429</span> </span><span class="WHIT">				</span><span class="REGX">/android 2\./</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Android 2.x"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>430</span> </span><span class="WHIT">				</span><span class="REGX">/android/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Android"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>431</span> </span><span class="WHIT">				</span><span class="REGX">/x11/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"X11"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>432</span> </span><span class="WHIT">				</span><span class="REGX">/linux/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Linux"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>433</span> </span><span class="WHIT">				</span><span class="REGX">/Mac OS X/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Mac OS X"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>434</span> </span><span class="WHIT">				</span><span class="REGX">/macintosh/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"Macintosh"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>435</span> </span><span class="WHIT">				</span><span class="STRN">"unknown"</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>436</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OS</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>437</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>438</span> 
<span class='linenumber'>439</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>440</span>     * Gets an object that is a collation of a number of browser and
<span class='linenumber'>441</span>     * client settings.  You can use this information to tailor a game
<span class='linenumber'>442</span>     * to the environment it is running within.
<span class='linenumber'>443</span>     * &lt;ul>
<span class='linenumber'>444</span>     * &lt;li>browser - A string indicating the browser type (safari, mozilla, opera, msie)&lt;/li>
<span class='linenumber'>445</span>     * &lt;li>version - The browser version&lt;/li>
<span class='linenumber'>446</span>     * &lt;li>agent - The user agent&lt;/li>
<span class='linenumber'>447</span>     * &lt;li>platform - The platform the browser is running on&lt;/li>
<span class='linenumber'>448</span>     * &lt;li>cpu - The CPU on the machine the browser is running on&lt;/li>
<span class='linenumber'>449</span>     * &lt;li>language - The browser's language&lt;/li>
<span class='linenumber'>450</span>     * &lt;li>online - If the browser is running in online mode&lt;/li>
<span class='linenumber'>451</span>     * &lt;li>cookies - If the browser supports cookies&lt;/li>
<span class='linenumber'>452</span>     * &lt;li>fullscreen - If the browser is running in fullscreen mode&lt;/li>
<span class='linenumber'>453</span>     * &lt;li>width - The browser's viewable width&lt;/li>
<span class='linenumber'>454</span>     * &lt;li>height - The browser's viewable height&lt;/li>
<span class='linenumber'>455</span>     * &lt;li>viewWidth - The innerWidth of the viewport&lt;/li>
<span class='linenumber'>456</span>     * &lt;li>viewHeight - The innerHeight of the viewport&lt;/li>
<span class='linenumber'>457</span>     * &lt;li>support:
<span class='linenumber'>458</span>     *    &lt;ul>&lt;li>xhr - Browser supports XMLHttpRequest object&lt;/li>
<span class='linenumber'>459</span>     *    &lt;li>geo - navigator.geolocation is supported&lt;/li>
<span class='linenumber'>460</span>     *    &lt;li>threads - Browser supports Worker threads&lt;/li>
<span class='linenumber'>461</span>     *    &lt;li>sockets - Browser supports WebSocket object&lt;/li>
<span class='linenumber'>462</span>     *    &lt;li>storage:
<span class='linenumber'>463</span>     *       &lt;ul>&lt;li>local - localStorage object is supported&lt;/li>
<span class='linenumber'>464</span>     *       &lt;li>session - sessionStorage object is supported&lt;/li>
<span class='linenumber'>465</span>     *       &lt;li>global - gloablStorage object is supported&lt;/li>
<span class='linenumber'>466</span>     *       &lt;li>database - indexedDB storage is supported&lt;/li>
<span class='linenumber'>467</span>     *       &lt;/ul>
<span class='linenumber'>468</span>     *    &lt;/li>
<span class='linenumber'>469</span>     *    &lt;li>canvas:
<span class='linenumber'>470</span>     *       &lt;ul>&lt;li>emulated - Canvas support emulated by FlashCanvas&lt;/li>
<span class='linenumber'>471</span>     *       &lt;li>defined - Canvas is either native or emulated&lt;/li>
<span class='linenumber'>472</span>     *       &lt;li>text - Supports text&lt;/li>
<span class='linenumber'>473</span>     *       &lt;li>textMetrics - Supports text measurement&lt;/li>
<span class='linenumber'>474</span>     *			&lt;li>contexts:
<span class='linenumber'>475</span>     *      		&lt;ul>&lt;li>ctx2D - Supports 2D&lt;/li>
<span class='linenumber'>476</span>     *				&lt;li>ctxGL - Supports webGL&lt;/li>
<span class='linenumber'>477</span>     *				&lt;/ul>
<span class='linenumber'>478</span>     *			&lt;/li>
<span class='linenumber'>479</span>     *       &lt;/ul>
<span class='linenumber'>480</span>     *    &lt;/li>
<span class='linenumber'>481</span>     *    &lt;/ul>
<span class='linenumber'>482</span>     * &lt;/li>
<span class='linenumber'>483</span>     * &lt;/ul>
<span class='linenumber'>484</span>     * @return An object with system information
<span class='linenumber'>485</span>     * @memberOf EngineSupport
<span class='linenumber'>486</span>     */</span><span class="WHIT">
<span class='linenumber'>487</span> </span><span class="WHIT">   </span><span class="NAME">sysInfo</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>488</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">EngineSupport._sysInfo</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>489</span> </span><span class="WHIT">      	</span><span class="WHIT">
<span class='linenumber'>490</span> </span><span class="WHIT">      	</span><span class="COMM">// Determine if the browser supports Canvas</span><span class="WHIT">
<span class='linenumber'>491</span> </span><span class="WHIT">      	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">canvasSupport</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>492</span> </span><span class="WHIT">      		</span><span class="NAME">emulated</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>493</span> </span><span class="WHIT">      		</span><span class="NAME">defined</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>494</span> </span><span class="WHIT">      		</span><span class="NAME">text</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>495</span> </span><span class="WHIT">      		</span><span class="NAME">textMetrics</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>496</span> </span><span class="WHIT">      		</span><span class="NAME">contexts</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>497</span> </span><span class="WHIT">      			</span><span class="NAME">ctx2D</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>498</span> </span><span class="WHIT">      			</span><span class="NAME">ctxGL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">
<span class='linenumber'>499</span> </span><span class="WHIT">      		</span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>500</span> </span><span class="WHIT">      	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>501</span> </span><span class="WHIT">      	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">document.addEventListener</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>502</span> </span><span class="WHIT">      		</span><span class="COMM">// Standards browsers</span><span class="WHIT">
<span class='linenumber'>503</span> </span><span class="WHIT">      		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">canvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>504</span> </span><span class="WHIT">      		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">canvas</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">canvas.getContext</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>505</span> </span><span class="WHIT">      			</span><span class="NAME">canvasSupport.defined</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>506</span> </span><span class="WHIT">	      		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c2d</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">canvas.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>507</span> </span><span class="WHIT">	      		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c2d</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>508</span> </span><span class="WHIT">	      			</span><span class="NAME">canvasSupport.contexts.ctx2D</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>509</span> </span><span class="WHIT">	      			</span><span class="WHIT">
<span class='linenumber'>510</span> </span><span class="WHIT">						</span><span class="COMM">// Does it support native text</span><span class="WHIT">
<span class='linenumber'>511</span> </span><span class="WHIT">						</span><span class="NAME">canvasSupport.text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c2d.fillText</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>512</span> </span><span class="WHIT">						</span><span class="NAME">canvasSupport.textMetrics</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c2d.measureText</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>513</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>514</span> </span><span class="WHIT">	      		</span><span class="WHIT">
<span class='linenumber'>515</span> </span><span class="WHIT">					</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>516</span> </span><span class="WHIT">		      		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">webGL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">canvas.getContext</span><span class="PUNC">(</span><span class="STRN">"glcanvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>517</span> </span><span class="WHIT">		      		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">webGL</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>518</span> </span><span class="WHIT">		      			</span><span class="NAME">canvasSupport.contexts.ctxGL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>519</span> </span><span class="WHIT">		      		</span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>520</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">/* no webgl */</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>521</span> </span><span class="WHIT">	      	</span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>522</span> </span><span class="WHIT">      	</span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>523</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='linenumber'>524</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">FlashCanvas</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>525</span> </span><span class="WHIT">				</span><span class="COMM">// If FlashCanvas is loaded, setup for emulation</span><span class="WHIT">
<span class='linenumber'>526</span> </span><span class="WHIT">      		</span><span class="NAME">canvasSupport.emulated</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>527</span> </span><span class="WHIT">      		</span><span class="NAME">canvasSupport.defined</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>528</span> </span><span class="WHIT">      		</span><span class="NAME">canvasSupport.contexts.ctx2D</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>529</span> </span><span class="WHIT">      		</span><span class="NAME">canvasSupport.text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>530</span> </span><span class="WHIT">				</span><span class="NAME">canvasSupport.textMetrics</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>531</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>532</span> </span><span class="WHIT">      	      </span><span class="WHIT">
<span class='linenumber'>533</span> </span><span class="WHIT">      	</span><span class="COMM">// Build support object</span><span class="WHIT">
<span class='linenumber'>534</span> </span><span class="WHIT">         </span><span class="NAME">EngineSupport._sysInfo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>535</span> </span><span class="WHIT">            </span><span class="STRN">"browser"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$.browser.chrome</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"chrome"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>536</span> </span><span class="WHIT">				           </span><span class="PUNC">(</span><span class="NAME">$.browser.android</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"android"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>537</span> </span><span class="WHIT">                       </span><span class="PUNC">(</span><span class="NAME">$.browser.Wii</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"wii"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>538</span> </span><span class="WHIT">                       </span><span class="PUNC">(</span><span class="NAME">$.browser.iPhone</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"iphone"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>539</span> </span><span class="WHIT">                       </span><span class="PUNC">(</span><span class="NAME">$.browser.safari</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"safari"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>540</span> </span><span class="WHIT">							  </span><span class="PUNC">(</span><span class="NAME">$.browser.firefox</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"firefox"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>541</span> </span><span class="WHIT">                       </span><span class="PUNC">(</span><span class="NAME">$.browser.mozilla</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"mozilla"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>542</span> </span><span class="WHIT">                       </span><span class="PUNC">(</span><span class="NAME">$.browser.opera</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"opera"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>543</span> </span><span class="WHIT">                       </span><span class="PUNC">(</span><span class="NAME">$.browser.msie</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"msie"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"unknown"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>544</span> </span><span class="WHIT">            </span><span class="STRN">"version"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$.browser.version</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>545</span> </span><span class="WHIT">            </span><span class="STRN">"agent"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.userAgent</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>546</span> </span><span class="WHIT">            </span><span class="STRN">"platform"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.platform</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>547</span> </span><span class="WHIT">            </span><span class="STRN">"cpu"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.cpuClass</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">navigator.oscpu</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>548</span> </span><span class="WHIT">				</span><span class="STRN">"OS"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">EngineSupport.checkOS</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>549</span> </span><span class="WHIT">            </span><span class="STRN">"language"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.language</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>550</span> </span><span class="WHIT">            </span><span class="STRN">"online"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.onLine</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>551</span> </span><span class="WHIT">            </span><span class="STRN">"cookies"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.cookieEnabled</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>552</span> </span><span class="WHIT">            </span><span class="STRN">"fullscreen"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">window.fullScreen</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>553</span> </span><span class="WHIT">            </span><span class="STRN">"support"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>554</span> </span><span class="WHIT">               </span><span class="STRN">"xhr"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>555</span> </span><span class="WHIT">               </span><span class="STRN">"threads"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Worker</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>556</span> </span><span class="WHIT">               </span><span class="STRN">"sockets"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">WebSocket</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>557</span> </span><span class="WHIT">               </span><span class="STRN">"storage"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Storage</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>558</span> </span><span class="WHIT">                  </span><span class="STRN">"local"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">localStorage</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>559</span> </span><span class="WHIT">                  </span><span class="STRN">"session"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">sessionStorage</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>560</span> </span><span class="WHIT">                  </span><span class="STRN">"database"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">indexedDB</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>561</span> </span><span class="WHIT">               </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>562</span> </span><span class="WHIT">               </span><span class="STRN">"geo"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">navigator.geolocation</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>563</span> </span><span class="WHIT">               </span><span class="STRN">"canvas"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">canvasSupport</span><span class="WHIT">
<span class='linenumber'>564</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>565</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>566</span> </span><span class="WHIT">         </span><span class="WHIT">
<span class='linenumber'>567</span> </span><span class="WHIT">         </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">ready</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>568</span> </span><span class="WHIT">            </span><span class="COMM">// When the document is ready, we'll go ahead and get the width and height added in</span><span class="WHIT">
<span class='linenumber'>569</span> </span><span class="WHIT">            </span><span class="NAME">EngineSupport._sysInfo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.extend</span><span class="PUNC">(</span><span class="NAME">EngineSupport._sysInfo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>570</span> </span><span class="WHIT">               </span><span class="STRN">"width"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>571</span> </span><span class="WHIT">               </span><span class="STRN">"height"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>572</span> </span><span class="WHIT">               </span><span class="STRN">"viewWidth"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>573</span> </span><span class="WHIT">               </span><span class="STRN">"viewHeight"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>574</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>575</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>576</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>577</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">EngineSupport._sysInfo</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>578</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>579</span> </span><span class="WHIT">   </span><span class="WHIT">
<span class='linenumber'>580</span> </span><span class="WHIT">   </span><span class="COMM">/**
<span class='linenumber'>581</span>     * When the object is no longer &lt;tt>undefined&lt;/tt>, the function will
<span class='linenumber'>582</span>     * be executed.
<span class='linenumber'>583</span>     * @param obj {Object} The object to wait for
<span class='linenumber'>584</span>     * @param fn {Function} The function to execute when the object is ready
<span class='linenumber'>585</span>     */</span><span class="WHIT">
<span class='linenumber'>586</span> </span><span class="WHIT">   </span><span class="NAME">whenReady</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>587</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>588</span> </span><span class="WHIT">         </span><span class="NAME">fn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>589</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>590</span> </span><span class="WHIT">         </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">arguments.callee</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>591</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>592</span> </span><span class="WHIT">   </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>593</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>594</span> 
<span class='linenumber'>595</span> </span></pre>
<hr>

   <div class="jsdoc_copy">The Render Engine &copy;2008-2010 Brett Fattori, All Rights Reserved</div>

<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoctoolkit.org/" target="_parent">JsDoc Toolkit</a> 1.4.1b on Wed Nov 17 2010 19:58:36 GMT-0500 (EST)</div>
</body>
</html>